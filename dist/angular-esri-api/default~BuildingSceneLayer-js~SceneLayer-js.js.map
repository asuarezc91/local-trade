{"version":3,"sources":["./node_modules/@arcgis/core/layers/support/I3SLayerDefinitions.js","./node_modules/@arcgis/core/layers/support/capabilities.js","./node_modules/@arcgis/core/layers/support/FetchAssociatedFeatureLayer.js"],"names":[],"mappings":"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","file":"default~BuildingSceneLayer-js~SceneLayer-js.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{JSONSupport as t}from\"../../core/JSONSupport.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{enumeration as r}from\"../../core/accessorSupport/decorators/enumeration.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";let s=class extends t{constructor(){super(...arguments),this.nodesPerPage=null,this.rootIndex=0,this.lodSelectionMetricType=null}};e([o({type:Number})],s.prototype,\"nodesPerPage\",void 0),e([o({type:Number})],s.prototype,\"rootIndex\",void 0),e([o({type:String})],s.prototype,\"lodSelectionMetricType\",void 0),s=e([p(\"esri.layer.support.I3SNodePageDefinition\")],s);let i=class extends t{constructor(){super(...arguments),this.factor=1}};e([o({type:Number,json:{read:{source:\"textureSetDefinitionId\"}}})],i.prototype,\"id\",void 0),e([o({type:Number})],i.prototype,\"factor\",void 0),i=e([p(\"esri.layer.support.I3SMaterialTexture\")],i);let a=class extends t{constructor(){super(...arguments),this.baseColorFactor=[1,1,1,1],this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.metallicFactor=1,this.roughnessFactor=1}};e([o({type:[Number]})],a.prototype,\"baseColorFactor\",void 0),e([o({type:i})],a.prototype,\"baseColorTexture\",void 0),e([o({type:i})],a.prototype,\"metallicRoughnessTexture\",void 0),e([o({type:Number})],a.prototype,\"metallicFactor\",void 0),e([o({type:Number})],a.prototype,\"roughnessFactor\",void 0),a=e([p(\"esri.layer.support.I3SMaterialPBRMetallicRoughness\")],a);let l=class extends t{constructor(){super(...arguments),this.alphaMode=\"opaque\",this.alphaCutoff=.25,this.doubleSided=!1,this.cullFace=\"none\",this.normalTexture=null,this.occlusionTexture=null,this.emissiveTexture=null,this.emissiveFactor=null,this.pbrMetallicRoughness=null}};e([r({opaque:\"opaque\",mask:\"mask\",blend:\"blend\"})],l.prototype,\"alphaMode\",void 0),e([o({type:Number})],l.prototype,\"alphaCutoff\",void 0),e([o({type:Boolean})],l.prototype,\"doubleSided\",void 0),e([r({none:\"none\",back:\"back\",front:\"front\"})],l.prototype,\"cullFace\",void 0),e([o({type:i})],l.prototype,\"normalTexture\",void 0),e([o({type:i})],l.prototype,\"occlusionTexture\",void 0),e([o({type:i})],l.prototype,\"emissiveTexture\",void 0),e([o({type:[Number]})],l.prototype,\"emissiveFactor\",void 0),e([o({type:a})],l.prototype,\"pbrMetallicRoughness\",void 0),l=e([p(\"esri.layer.support.I3SMaterialDefinition\")],l);let n=class extends t{};e([o({type:String,json:{read:{source:[\"name\",\"index\"],reader:(e,t)=>null!=e?e:`${t.index}`}}})],n.prototype,\"name\",void 0),e([r({jpg:\"jpg\",png:\"png\",dds:\"dds\",\"ktx-etc2\":\"ktx-etc2\",ktx2:\"ktx2\",basis:\"basis\"})],n.prototype,\"format\",void 0),n=e([p(\"esri.layer.support.I3STextureFormat\")],n);let u=class extends t{constructor(){super(...arguments),this.atlas=!1}};e([o({type:[n]})],u.prototype,\"formats\",void 0),e([o({type:Boolean})],u.prototype,\"atlas\",void 0),u=e([p(\"esri.layer.support.I3STextureSetDefinition\")],u);let y=class extends t{};e([r({Float32:\"Float32\",UInt64:\"UInt64\",UInt32:\"UInt32\",UInt16:\"UInt16\",UInt8:\"UInt8\"})],y.prototype,\"type\",void 0),e([o({type:Number})],y.prototype,\"component\",void 0),y=e([p(\"esri.layer.support.I3SGeometryAttribute\")],y);let d=class extends t{};e([r({draco:\"draco\"})],d.prototype,\"encoding\",void 0),e([o({type:[String]})],d.prototype,\"attributes\",void 0),d=e([p(\"esri.layer.support.I3SGeometryCompressedAttributes\")],d);let c=class extends t{constructor(){super(...arguments),this.offset=0}};e([o({type:Number})],c.prototype,\"offset\",void 0),e([o({type:y})],c.prototype,\"position\",void 0),e([o({type:y})],c.prototype,\"normal\",void 0),e([o({type:y})],c.prototype,\"uv0\",void 0),e([o({type:y})],c.prototype,\"color\",void 0),e([o({type:y})],c.prototype,\"uvRegion\",void 0),e([o({type:y})],c.prototype,\"featureId\",void 0),e([o({type:y})],c.prototype,\"faceRange\",void 0),e([o({type:d})],c.prototype,\"compressedAttributes\",void 0),c=e([p(\"esri.layer.support.I3SGeometryBuffer\")],c);let m=class extends t{};e([r({triangle:\"triangle\"})],m.prototype,\"topology\",void 0),e([o()],m.prototype,\"geometryBuffers\",void 0),m=e([p(\"esri.layer.support.I3SGeometryDefinition\")],m);export{y as I3SGeometryAttribute,c as I3SGeometryBuffer,d as I3SGeometryCompressedAttributes,m as I3SGeometryDefinition,l as I3SMaterialDefinition,a as I3SMaterialPBRMetallicRoughness,i as I3SMaterialTexture,s as I3SNodePageDefinition,n as I3STextureFormat,u as I3STextureSetDefinition};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nconst t={attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}};export{t as zeroCapabilities};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{id as t}from\"../../kernel.js\";import r from\"../../request.js\";import{isNone as e,isSome as a}from\"../../core/maybe.js\";import{throwIfAbortError as i}from\"../../core/promiseUtils.js\";import s from\"../FeatureLayer.js\";import n from\"../../portal/Portal.js\";import o from\"../../portal/PortalItem.js\";class l{constructor(t,r,e,a){this.parsedUrl=t,this.portalItem=r,this.apiKey=e,this.signal=a,this.rootDocument=null;const i=this.parsedUrl.path.match(/^(.*)\\/SceneServer\\/layers\\/([\\d]*)\\/?$/i);i&&(this.urlParts={root:i[1],layerId:parseInt(i[2],10)})}async fetch(){var t;if(!this.urlParts)return null;const r=null!=(t=this.portalItem)?t:await this._portalItemFromServiceItemId();if(e(r))return this._loadFromUrl();const a=await this._findAndLoadRelatedPortalItem(r);return e(a)?null:this._loadFeatureLayerFromPortalItem(a)}async fetchPortalItem(){var t;if(!this.urlParts)return null;const r=null!=(t=this.portalItem)?t:await this._portalItemFromServiceItemId();return e(r)?null:this._findAndLoadRelatedPortalItem(r)}async _fetchRootDocument(){if(a(this.rootDocument))return this.rootDocument;if(e(this.urlParts))return this.rootDocument={},{};const t={query:{f:\"json\",token:this.apiKey},responseType:\"json\",signal:this.signal},i=`${this.urlParts.root}/SceneServer`;try{const e=await r(i,t);this.rootDocument=e.data}catch{this.rootDocument={}}return this.rootDocument}async _fetchServiceOwningPortalUrl(){var e;const a=null==(e=t)?void 0:e.findServerInfo(this.parsedUrl.path);if(null!=a&&a.owningSystemUrl)return a.owningSystemUrl;const s=this.parsedUrl.path.replace(/(.*\\/rest)\\/.*/i,\"$1\")+\"/info\";try{const t=(await r(s,{query:{f:\"json\"},responseType:\"json\",signal:this.signal})).data.owningSystemUrl;if(t)return t}catch(n){i(n)}return null}async _findAndLoadRelatedPortalItem(t){try{return(await t.fetchRelatedItems({relationshipType:\"Service2Service\",direction:\"reverse\"},{signal:this.signal})).find((t=>\"Feature Service\"===t.type))||null}catch(r){return i(r),null}}async _loadFeatureLayerFromPortalItem(t){await t.load({signal:this.signal});const r=await this._findMatchingAssociatedSublayerUrl(t.url);return new s({url:r,portalItem:t}).load({signal:this.signal})}async _loadFromUrl(){const t=await this._findMatchingAssociatedSublayerUrl(`${this.urlParts.root}/FeatureServer`);return new s({url:t}).load({signal:this.signal})}async _findMatchingAssociatedSublayerUrl(t){const e=t.replace(/^(.*FeatureServer)(\\/[\\d]*\\/?)?$/i,\"$1\"),a={query:{f:\"json\"},responseType:\"json\",authMode:\"no-prompt\",signal:this.signal},i=this.urlParts.layerId,s=this._fetchRootDocument(),n=r(e,a),[o,l]=await Promise.all([n,s]),c=l&&l.layers,h=o.data&&o.data.layers;if(!Array.isArray(h))throw new Error(\"expected layers array\");if(Array.isArray(c))for(let r=0;r<Math.min(c.length,h.length);r++){if(c[r].id===i)return`${e}/${h[r].id}`}else if(i<h.length)return`${e}/${h[i].id}`;throw new Error(\"could not find matching associated sublayer\")}async _portalItemFromServiceItemId(){const t=(await this._fetchRootDocument()).serviceItemId;if(!t)return null;const r=new o({id:t,apiKey:this.apiKey}),e=await this._fetchServiceOwningPortalUrl();a(e)&&(r.portal=new n({url:e}));try{return r.load({signal:this.signal})}catch(s){return i(s),null}}}export{l as FetchAssociatedFeatureLayer};\n"],"sourceRoot":"webpack:///"}
{"version":3,"sources":["./node_modules/@arcgis/core/core/sql/WhereClauseCache.js","./node_modules/@arcgis/core/layers/graphics/data/utils.js","./node_modules/@arcgis/core/layers/graphics/data/QueryEngineResult.js","./node_modules/@arcgis/core/layers/graphics/data/spatialQuerySupport.js","./node_modules/@arcgis/core/geometry/support/intersects.js","./node_modules/@arcgis/core/layers/graphics/contains.js","./node_modules/@arcgis/core/layers/graphics/data/AttributesBuilder.js","./node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js","./node_modules/@arcgis/core/layers/graphics/data/timeSupport.js","./node_modules/@arcgis/core/layers/graphics/data/QueryEngineCapabilities.js","./node_modules/@arcgis/core/layers/graphics/data/attributeSupport.js"],"names":[],"mappings":"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","file":"default~layers-graphics-sources-WFSSourceWorker-js~layers-graphics-sources-geojson-GeoJSONSourceWork~314a8d40.js","sourcesContent":["/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\r\n*/\r\nimport t from\"../ItemCache.js\";import{WhereClause as e}from\"./WhereClause.js\";class c{constructor(e,c){this._cache=new t(e),this._invalidCache=new t(c)}get(t,c){const i=`${c.uid}:${t}`,r=this._cache.get(i);if(r)return r;if(void 0!==this._invalidCache.get(i))return null;try{const r=e.create(t,c);return this._cache.put(i,r),r}catch{return this._invalidCache.put(i,null),null}}}export{c as WhereClauseCache};\r\n","/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\r\n*/\r\nimport{JSONMap as e}from\"../../../core/jsonMap.js\";import{isNone as t,isSome as r}from\"../../../core/maybe.js\";import{getUnitString as i}from\"../../../core/unitUtils.js\";import{getGeometryExtent as o}from\"../../../geometry/support/extentUtils.js\";import{fromJSON as n}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as s}from\"../../../geometry/support/normalizeUtils.js\";import{isGeographic as l,isWebMercator as a,WGS84 as m}from\"../../../geometry/support/spatialReferenceUtils.js\";import{getCentroidOptimizedGeometry as c}from\"../centroid.js\";import{quantizeOptimizedGeometry as u,convertToPoint as f,generalizeOptimizedGeometry as p,removeZMValues as y,convertToPolyline as g,convertToPolygon as S,convertToMultipoint as R}from\"../featureConversionUtils.js\";import d from\"../OptimizedGeometry.js\";import{checkProjectionSupport as h,project as w}from\"./projectionSupport.js\";const j=new e({esriSRUnit_Meter:\"meters\",esriSRUnit_Kilometer:\"kilometers\",esriSRUnit_Foot:\"feet\",esriSRUnit_StatuteMile:\"miles\",esriSRUnit_NauticalMile:\"nautical-miles\",esriSRUnit_USNauticalMile:\"us-nautical-miles\"}),U=Object.freeze({}),M=new d,F=new d,G=new d,N={esriGeometryPoint:f,esriGeometryPolyline:g,esriGeometryPolygon:S,esriGeometryMultipoint:R};function O(e,r,i,o=e.hasZ,n=e.hasM){if(t(r))return null;const s=e.hasZ&&o,l=e.hasM&&n;if(i){const t=u(G,r,e.hasZ,e.hasM,\"esriGeometryPoint\",i,o,n);return f(t,s,l)}return f(r,s,l)}function _(e,t,r){return\"esriGeometryPolygon\"===e.geometryType&&t&&(t.centroid||t.geometry)?(t.centroid||(t.centroid=c(new d,t.geometry,e.hasZ,e.hasM)),O(e,t.centroid,r)):null}function J(e,i,o,n,s,l,a=i,m=o){const c=i&&a,f=o&&m,g=r(n)?\"coords\"in n?n:n.geometry:null;if(t(g))return null;if(s){let t=p(F,g,i,o,e,s,a,m);return l&&(t=u(G,t,c,f,e,l)),N[e](t,c,f)}if(l){const t=u(G,g,i,o,e,l,a,m);return N[e](t,c,f)}return y(M,g,i,o,a,m),N[e](M,c,f)}async function P(e,t,r){const{outFields:i,orderByFields:o,groupByFieldsForStatistics:n,outStatistics:s}=e;if(i)for(let l=0;l<i.length;l++)i[l]=i[l].trim();if(o)for(let l=0;l<o.length;l++)o[l]=o[l].trim();if(n)for(let l=0;l<n.length;l++)n[l]=n[l].trim();if(s)for(let l=0;l<s.length;l++)s[l].onStatisticField&&(s[l].onStatisticField=s[l].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),Z(e,t,r)}async function v(e,t,r){return Z(e,t,r)}async function Z(e,r,i){if(!e)return null;let{where:l}=e;if(e.where=l=l&&l.trim(),(!l||/^1 *= *1$/.test(l)||r&&r===l)&&(e.where=null),!e.geometry)return e;let a=await b(e);if(e.distance=0,e.units=null,\"esriSpatialRelEnvelopeIntersects\"===e.spatialRel){const{spatialReference:t}=e.geometry;a=o(a),a.spatialReference=t}e.geometry=a,await h(a.spatialReference,i);const m=(await s(n(a)))[0];if(t(m))throw U;const c=m.toJSON(),u=await w(c,c.spatialReference,i);if(!u)throw U;return u.spatialReference=i,e.geometry=u,e}async function b(e){const{geometry:t,distance:r,units:o}=e;if(null==r||\"vertexAttributes\"in t)return t;const n=t.spatialReference,s=o?j.fromJSON(o):i(n),c=n&&(l(n)||a(n))?t:await h(n,m).then((()=>w(t,m)));return(await x())(c.spatialReference,c,r,s)}async function x(){return(await import(\"../../../geometry/geometryEngineJSON.js\")).geodesicBuffer}function z(e){return e&&B in e?JSON.parse(JSON.stringify(e,E)):e}const B=\"_geVersion\",E=(e,t)=>e!==B?t:void 0;export{U as QUERY_ENGINE_EMPTY_RESULT,z as cleanFromGeometryEngine,_ as getCentroid,J as getGeometry,v as normalizeFilter,P as normalizeQuery,Z as normalizeQueryLike,O as transformCentroid};\r\n","/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\r\n*/\r\nimport{isNone as e,isSome as t}from\"../../../core/maybe.js\";import{polygonCentroid as i,extentCentroid as s}from\"../../../geometry/support/centroid.js\";import{getPolygonExtent as a,getGeometryExtent as r}from\"../../../geometry/support/extentUtils.js\";import{toQuantizationTransform as n}from\"../../../geometry/support/quantizationUtils.js\";import{isValid as o,equals as l}from\"../../../geometry/support/spatialReferenceUtils.js\";import{convertFromGeometry as u}from\"../featureConversionUtils.js\";import c from\"./AttributesBuilder.js\";import{getWhereClause as m}from\"./attributeSupport.js\";import{project as d,projectMany as h}from\"./projectionSupport.js\";import{getTimeOperator as f}from\"./timeSupport.js\";import{cleanFromGeometryEngine as p,getGeometry as g,transformCentroid as y}from\"./utils.js\";import{isStringField as I}from\"../../support/fieldUtils.js\";import{isNullCountSupported as x,calculateStringStatistics as T,calculateStatistics as F,processSummaryStatisticsResult as V,calculateUniqueValuesCount as v,createUVResult as b,calculateClassBreaks as z,resolveCBResult as A,calculateHistogram as S,getAttributeComparator as _,calculatePercentile as E}from\"../../../statistics/utils.js\";import{loadArcade as R}from\"../../../support/arcadeOnDemand.js\";class G{constructor(e,t,i){this.items=e,this.queryGeometry=t,this.definitionExpression=i.definitionExpression,this.geometryType=i.geometryType,this.hasM=i.hasM,this.hasZ=i.hasZ,this.objectIdField=i.objectIdField,this.spatialReference=i.spatialReference,this.fieldsIndex=i.fieldsIndex,this.timeInfo=i.timeInfo,this.featureAdapter=i.featureAdapter,this.aggregateAdapter=i.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(e){const t=new c(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);const{groupByFieldsForStatistics:i,having:s}=e;if(!!!(null==i?void 0:i.length))return 1;const a=new Map,r=new Map,n=new Set,o=e.outStatistics;for(const l of o){const{statisticType:e}=l,o=\"exceedslimit\"!==e?l.onStatisticField:void 0;if(!r.has(o)){const e=[];for(const s of i){const i=this._getAttributeValues(t,s,a);e.push(i)}r.set(o,this._calculateUniqueValues(e,t.returnDistinctValues))}const u=r.get(o);for(const i in u){const{data:e,items:a}=u[i],r=e.join(\",\");s&&!t.validateItems(a,s)||n.add(r)}}return n.size}async createQueryResponse(e){let t;if(e.outStatistics){t=e.outStatistics.some((e=>\"exceedslimit\"===e.statisticType))?this._createExceedsLimitQueryResponse(e):await this._createStatisticsQueryResponse(e)}else t=this._createFeatureQueryResponse(e);return e.returnQueryGeometry&&(o(e.outSR)&&!l(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=p({spatialReference:e.outSR,...d(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR)}):t.queryGeometry=p({spatialReference:e.outSR,...this.queryGeometry})),t}createSnappingResponse(t,i){const s=this.featureAdapter,a=w(this.hasZ,this.hasM),{x:r,y:n}=t.point,o=\"number\"==typeof t.distance?t.distance:t.distance.x,l=\"number\"==typeof t.distance?t.distance:t.distance.y,u={candidates:[]},c=\"esriGeometryPolygon\"===this.geometryType,m=this._getPointCreator(t.point,this.spatialReference,i);for(const d of this.items){const i=s.getGeometry(d);if(e(i))continue;const{coords:h,lengths:f}=i;if(t.types&N.EDGE){let e=0;for(let t=0;t<f.length;t++){const i=f[t];for(let t=0;t<i;t++,e+=a){const c=h[e],f=h[e+1];if(t!==i-1){const t=h[e+a],i=h[e+a+1],{x:p,y:g}=j(r,n,c,f,t,i),y=(r-p)/o,I=(n-g)/l,x=y*y+I*I;x<=1&&u.candidates.push({type:\"edge\",objectId:s.getObjectId(d),distance:Math.sqrt(x),target:m(p,g),start:m(c,f),end:m(t,i)})}}}}if(t.types&N.VERTEX){const e=c?h.length-a:h.length;for(let t=0;t<e;t+=a){const e=h[t],i=h[t+1],a=(r-e)/o,c=(n-i)/l,f=a*a+c*c;f<=1&&u.candidates.push({type:\"vertex\",objectId:s.getObjectId(d),distance:Math.sqrt(f),target:m(e,i)})}}}return u.candidates.sort(((e,t)=>e.distance-t.distance)),u}_getPointCreator(e,i,s){const a=t(s)&&!l(i,s)?e=>d(e,i,s):e=>e;return null!=e.z&&null!=e.m?(t,i)=>a({x:t,y:i,z:e.z,m:e.m}):null!=e.z?(t,i)=>a({x:t,y:i,z:e.z}):null!=e.m?(t,i)=>a({x:t,y:i,m:e.m}):(e,t)=>a({x:e,y:t})}executeAttributesQuery(e){const t=m(e.where,this.fieldsIndex);if(!t)return Promise.resolve(this);if(t.isStandardized){let i=0;const s=[];for(const e of this.items)t.testFeature(e,this.featureAdapter)&&(s[i++]=e);const a=new G(s,this.queryGeometry,this);return a.definitionExpression=e.where,Promise.resolve(a)}return Promise.reject(new TypeError(\"Where clause is not standardized\"))}executeAggregateIdsQuery(t){if(!t.aggregateIds||!t.aggregateIds.length||e(this.aggregateAdapter))return Promise.resolve(this);const i=new Set;for(const e of t.aggregateIds){this.aggregateAdapter.getFeatureObjectIds(e).forEach((e=>i.add(e)))}const s=this.featureAdapter.getObjectId;return Promise.resolve(new G(this.items.filter((e=>i.has(s(e)))),this.queryGeometry,this))}executeObjectIdsQuery(e){if(!e.objectIds||!e.objectIds.length)return Promise.resolve(this);const t=new Set(e.objectIds),i=this.featureAdapter.getObjectId;return Promise.resolve(new G(this.items.filter((e=>t.has(i(e)))),this.queryGeometry,this))}executeTimeQuery(e){const i=f(this.timeInfo,e.timeExtent,this.featureAdapter);if(!t(i))return Promise.resolve(this);const s=this.items.filter(i);return Promise.resolve(new G(s,this.queryGeometry,this))}filterLatest(){const{trackIdField:e,startTimeField:t,endTimeField:i}=this.timeInfo,s=i||t,a=new Map,r=this.featureAdapter.getAttribute;for(const o of this.items){const t=r(o,e),i=r(o,s),n=a.get(t);(!n||i>r(n,s))&&a.set(t,o)}const n=Array.from(a.values());return Promise.resolve(new G(n,this.queryGeometry,this))}async project(e){if(!e||l(this.spatialReference,e))return this;const t=this.featureAdapter,i=(await h(this.items.map((e=>g(this.geometryType,this.hasZ,this.hasM,t.getGeometry(e)))),this.spatialReference,e)).map(((e,i)=>t.cloneWithGeometry(this.items[i],u(e,this.hasZ,this.hasM))));return new G(i,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:e,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})}async createSummaryStatisticsResponse(e,t){const{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,minValue:o,maxValue:l,scale:u}=t,c=this.fieldsIndex.isDateField(i),m=await this._getDataValues(e,{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,scale:u}),d=x({normalizationType:r,normalizationField:a,minValue:o,maxValue:l}),h=this.fieldsIndex.get(i),f={value:.5,fieldType:null==h?void 0:h.type},p=I(h)?T({values:m,supportsNullCount:d,percentileParams:f}):F({values:m,minValue:o,maxValue:l,useSampleStdDev:!r,supportsNullCount:d,percentileParams:f});return V(p,c)}async createUniqueValuesResponse(e,t){const{field:i,valueExpression:s,domain:a,returnAllCodedValues:r,scale:n}=t,o=await this._getDataValues(e,{field:i,valueExpression:s,scale:n}),l=v(o);return b(l,a,r)}async createClassBreaksResponse(e,t){const{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,classificationMethod:o,standardDeviationInterval:l,minValue:u,maxValue:c,numClasses:m,scale:d}=t,h=await this._getDataValues(e,{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,scale:d}),f=z(h,{field:i,normalizationField:a,normalizationType:r,normalizationTotal:n,classificationMethod:o,standardDeviationInterval:l,minValue:u,maxValue:c,numClasses:m});return A(f,o)}async createHistogramResponse(e,t){const{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,classificationMethod:o,standardDeviationInterval:l,minValue:u,maxValue:c,numBins:m,scale:d}=t,h=await this._getDataValues(e,{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,scale:d});return S(h,{field:i,normalizationField:a,normalizationType:r,normalizationTotal:n,classificationMethod:o,standardDeviationInterval:l,minValue:u,maxValue:c,numBins:m})}_sortFeatures(e,t,i){if(e.length>1&&t&&t.length)for(const s of t.reverse()){const t=s.split(\" \"),a=t[0],r=this.fieldsIndex.get(a),n=t[1]&&\"desc\"===t[1].toLowerCase(),o=_(null==r?void 0:r.type,n);e.sort(((e,t)=>{const s=i(e,a,r),n=i(t,a,r);return o(s,n)}))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:i,hasM:s,hasZ:a,objectIdField:r,spatialReference:o}=this,{outFields:l,outSR:u,quantizationParameters:c,resultRecordCount:m,resultOffset:d,returnZ:h,returnM:f}=e,g=null!=m&&t.length>(d||0)+m,y=l&&(l.includes(\"*\")?[...this.fieldsIndex.fields]:l.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:g,features:this._createFeatures(e,t),fields:y,geometryType:i,hasM:s&&f,hasZ:a&&h,objectIdFieldName:r,spatialReference:p(u||o),transform:c&&n(c)||null}}_createFeatures(e,t){const i=new c(e,this.featureAdapter,this.fieldsIndex),{hasM:s,hasZ:a}=this,{orderByFields:r,quantizationParameters:o,returnGeometry:l,returnCentroid:u,maxAllowableOffset:m,resultOffset:d,resultRecordCount:h,returnZ:f=!1,returnM:p=!1}=e,I=a&&f,x=s&&p;let T=[],F=0;const V=[...t];if(this._sortFeatures(V,r,((e,t,s)=>i.getFieldValue(e,t,s))),l||u){const e=n(o);if(l&&!u)for(const t of V)T[F++]={attributes:i.getAttributes(t),geometry:g(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),m,e,I,x)};else if(!l&&u)for(const t of V)T[F++]={attributes:i.getAttributes(t),centroid:y(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of V)T[F++]={attributes:i.getAttributes(t),centroid:y(this,this.featureAdapter.getCentroid(t,this),e),geometry:g(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),m,e,I,x)}}else for(const n of V){const e=i.getAttributes(n);e&&(T[F++]={attributes:e})}const v=d||0;if(null!=h){const e=v+h;T=T.slice(v,Math.min(T.length,e))}return T}_createExceedsLimitQueryResponse(e){let i=!1,s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;for(const t of e.outStatistics)if(\"exceedslimit\"===t.statisticType){s=null!=t.maxPointCount?t.maxPointCount:Number.POSITIVE_INFINITY,a=null!=t.maxRecordCount?t.maxRecordCount:Number.POSITIVE_INFINITY,r=null!=t.maxVertexCount?t.maxVertexCount:Number.POSITIVE_INFINITY;break}if(\"esriGeometryPoint\"===this.geometryType)i=this.items.length>s;else if(this.items.length>a)i=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,s=this.featureAdapter;i=this.items.reduce(((e,i)=>{const a=s.getGeometry(i);return e+(t(a)&&a.coords.length||0)}),0)/e>r}return{fields:[{name:\"exceedslimit\",type:\"esriFieldTypeInteger\",alias:\"exceedslimit\",sqlType:\"sqlTypeInteger\",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(i)}}]}}async _createStatisticsQueryResponse(e){const t={attributes:{}},i=[],s=new Map,a=new Map,r=new Map,n=new Map,o=new c(e,this.featureAdapter,this.fieldsIndex),l=e.outStatistics,{groupByFieldsForStatistics:u,having:m,orderByFields:d}=e,h=u&&u.length,f=!!h,p=f&&u[0],g=f&&!this.fieldsIndex.get(p);for(const c of l){const{outStatisticFieldName:e,statisticType:l}=c,d=c,y=\"exceedslimit\"!==l?c.onStatisticField:void 0,I=\"percentile_disc\"===l||\"percentile_cont\"===l,x=\"EnvelopeAggregate\"===l||\"CentroidAggregate\"===l||\"ConvexHullAggregate\"===l,T=f&&1===h&&(y===p||g)&&\"count\"===l;if(f){if(!r.has(y)){const e=[];for(const t of u){const i=this._getAttributeValues(o,t,s);e.push(i)}r.set(y,this._calculateUniqueValues(e,o.returnDistinctValues))}const t=r.get(y);for(const i in t){const{count:a,data:r,items:l,itemPositions:c}=t[i],h=r.join(\",\");if(!m||o.validateItems(l,m)){const t=n.get(h)||{attributes:{}};if(x){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:i}=await this._getAggregateGeometry(d,l);t.aggregateGeometries[i]=e}else{let i=null;if(T)i=a;else{const e=this._getAttributeValues(o,y,s),t=c.map((t=>e[t]));i=I&&\"statisticParameters\"in d?this._getPercentileValue(d,t):this._getStatisticValue(d,t,null,o.returnDistinctValues)}t.attributes[e]=i}u.forEach(((e,i)=>t.attributes[this.fieldsIndex.get(e)?e:`EXPR_${i+1}`]=r[i])),n.set(h,t)}}}else if(x){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:i}=await this._getAggregateGeometry(d,this.items);t.aggregateGeometries[i]=e}else{const i=this._getAttributeValues(o,y,s);t.attributes[e]=I&&\"statisticParameters\"in d?this._getPercentileValue(d,i):this._getStatisticValue(d,i,a,o.returnDistinctValues)}i.push({name:e,alias:e,type:\"esriFieldTypeDouble\"})}const y=f?Array.from(n.values()):[t];return this._sortFeatures(y,d,((e,t)=>e.attributes[t])),{fields:i,features:y}}async _getAggregateGeometry(e,t){const n=await import(\"../../../geometry/geometryEngineJSON.js\"),{statisticType:o,outStatisticFieldName:l}=e,{featureAdapter:u,spatialReference:c,geometryType:m,hasZ:d,hasM:h}=this,f=t.map((e=>g(m,d,h,u.getGeometry(e)))),p=n.convexHull(c,f,!0)[0],y={aggregateGeometries:null,outStatisticFieldName:null};if(\"EnvelopeAggregate\"===o){const e=p?a(p):r(n.union(c,f));y.aggregateGeometries={...e,spatialReference:c},y.outStatisticFieldName=l||\"extent\"}else if(\"CentroidAggregate\"===o){const e=p?i(p):s(r(n.union(c,f)));y.aggregateGeometries={x:e[0],y:e[1],spatialReference:c},y.outStatisticFieldName=l||\"centroid\"}else\"ConvexHullAggregate\"===o&&(y.aggregateGeometries=p,y.outStatisticFieldName=l||\"convexHull\");return y}_getStatisticValue(e,t,i,s){const{onStatisticField:a,statisticType:r}=e;let n=null;n=null!=i&&i.has(a)?i.get(a):I(this.fieldsIndex.get(a))?T({values:t,returnDistinct:s}):F({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),i&&i.set(a,n);return n[\"var\"===r?\"variance\":r]}_getPercentileValue(e,t){const{onStatisticField:i,statisticParameters:s,statisticType:a}=e,{value:r,orderBy:n}=s,o=this.fieldsIndex.get(i),l={value:r,orderBy:n,fieldType:null==o?void 0:o.type,isDiscrete:\"percentile_disc\"===a};return E(t,l)}_getAttributeValues(e,t,i){if(i.has(t))return i.get(t);const s=this.fieldsIndex.get(t),a=this.items.map((i=>e.getFieldValue(i,t,s)));return i.set(t,a),a}_getAttributeNormalizedValues(e,t){return this.items.map((i=>e.getNormalizedValue(i,{field:t.field,fieldInfo:this.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})))}async _getAttributeExpressionValues(e,t,i){const{arcadeUtils:s}=await R(),a=s.createFunction(t),r=i&&s.getViewInfo(i);return this.items.map((t=>e.getExpressionValue(t,{compiledFunc:a,viewInfo:r},s)))}_calculateUniqueValues(e,t){const i={},s=this.items,a=s.length;for(let r=0;r<a;r++){const a=s[r],n=[];for(const t of e)n.push(t[r]);const o=n.join(\",\");t?null==i[o]&&(i[o]={count:1,data:n,items:[a],itemPositions:[r]}):null==i[o]?i[o]={count:1,data:n,items:[a],itemPositions:[r]}:(i[o].count++,i[o].items.push(a),i[o].itemPositions.push(r))}return i}async _getDataValues(e,t){const i=new c(e,this.featureAdapter,this.fieldsIndex),{valueExpression:s,field:a,normalizationField:r,normalizationType:n,normalizationTotal:o,scale:l}=t,u=s?{viewingMode:\"map\",scale:l,spatialReference:e.outSR||this.spatialReference}:null;return s?this._getAttributeExpressionValues(i,s,u):this._getAttributeNormalizedValues(i,{field:a,normalizationField:r,normalizationType:n,normalizationTotal:o})}}function j(e,t,i,s,a,r){const n=a-i,o=r-s,l=n*n+o*o,u=(e-i)*n+(t-s)*o,c=Math.min(1,Math.max(0,u/l));return{x:i+n*c,y:s+o*c}}function w(e,t){return e?t?4:3:t?3:2}var N;!function(e){e[e.NONE=0]=\"NONE\",e[e.EDGE=1]=\"EDGE\",e[e.VERTEX=2]=\"VERTEX\"}(N||(N={}));export{N as SnappingTypes,G as default};\r\n","/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\r\n*/\r\nimport e from\"../../../core/Error.js\";import{extentContainsPoint as r,extentContainsMultipoint as t}from\"../../../geometry/support/contains.js\";import{getExtentIntersector as i}from\"../../../geometry/support/intersects.js\";import{isPolygon as s,isExtent as o,getJsonType as n}from\"../../../geometry/support/jsonUtils.js\";import{isValid as l}from\"../../../geometry/support/spatialReferenceUtils.js\";import{polygonContainsPoint as a,polygonContainsMultipoint as p}from\"../contains.js\";import{convertFromPolygon as m}from\"../featureConversionUtils.js\";import u from\"../OptimizedGeometry.js\";import{checkProjectionSupport as y}from\"./projectionSupport.js\";import{getGeometry as f}from\"./utils.js\";const c=\"feature-store:unsupported-query\",R={esriSpatialRelIntersects:\"intersects\",esriSpatialRelContains:\"contains\",esriSpatialRelCrosses:\"crosses\",esriSpatialRelDisjoint:\"disjoint\",esriSpatialRelEnvelopeIntersects:\"intersects\",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:\"overlaps\",esriSpatialRelTouches:\"touches\",esriSpatialRelWithin:\"within\",esriSpatialRelRelation:null},S={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function G(e){return!0===S.spatialRelationship[e]}function g(e){return!0===S.queryGeometry[n(e)]}function j(e){return!0===S.layerGeometry[e]}function h(){return import(\"../../../geometry/geometryEngineJSON.js\")}function v(e,n,l,y,c){if(s(n)&&\"esriGeometryPoint\"===l&&(\"esriSpatialRelIntersects\"===e||\"esriSpatialRelContains\"===e)){const e=m(new u,n,!1,!1);return Promise.resolve((r=>a(e,!1,!1,r)))}if(s(n)&&\"esriGeometryMultipoint\"===l){const r=m(new u,n,!1,!1);if(\"esriSpatialRelContains\"===e)return Promise.resolve((e=>p(r,!1,!1,e,y,c)))}if(o(n)&&\"esriGeometryPoint\"===l&&(\"esriSpatialRelIntersects\"===e||\"esriSpatialRelContains\"===e))return Promise.resolve((e=>r(n,f(l,y,c,e))));if(o(n)&&\"esriGeometryMultipoint\"===l&&\"esriSpatialRelContains\"===e)return Promise.resolve((e=>t(n,f(l,y,c,e))));if(o(n)&&\"esriSpatialRelIntersects\"===e){const e=i(l);return Promise.resolve((r=>e(n,f(l,y,c,r))))}return h().then((r=>{const t=r[R[e]].bind(null,n.spatialReference,n);return e=>t(f(l,y,c,e))}))}async function P(r,t,i){const{spatialRel:s,geometry:o}=r;if(o){if(!G(s))throw new e(c,\"Unsupported query spatial relationship\",{query:r});if(l(o.spatialReference)&&l(i)){if(!g(o))throw new e(c,\"Unsupported query geometry type\",{query:r});if(!j(t))throw new e(c,\"Unsupported layer geometry type\",{query:r});if(r.outSR)return y(r.geometry&&r.geometry.spatialReference,r.outSR)}}}function I(e){if(o(e))return!0;if(s(e)){for(const r of e.rings){if(5!==r.length)return!1;if(r[0][0]!==r[1][0]||r[0][0]!==r[4][0]||r[2][0]!==r[3][0]||r[0][1]!==r[3][1]||r[0][1]!==r[4][1]||r[1][1]!==r[2][1])return!1}return!0}return!1}export{I as canQueryWithRBush,P as checkSpatialQuerySupport,v as getSpatialQueryOperator};\r\n","/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\r\n*/\r\nimport{extentIntersectsExtent as e,getFeatureExtentIntersector as t}from\"./intersectsBase.js\";export{extentIntersectsExtent,extentIntersectsMultipoint,extentIntersectsPoint,extentIntersectsPolygon,extentIntersectsPolyline,getFeatureExtentIntersector,isSelfIntersecting,segmentIntersects}from\"./intersectsBase.js\";function n(n){return\"mesh\"===n?e:t(n)}export{n as getExtentIntersector};\r\n","/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\r\n*/\r\nfunction n(n,t){return n?t?4:3:t?3:2}function t(n,t,r,e){return o(n,t,r,e.coords[0],e.coords[1])}function r(t,r,e,c,u,f){const s=n(u,f),{coords:i,lengths:l}=c;if(!l)return!1;for(let n=0,d=0;n<l.length;n++,d+=s)if(!o(t,r,e,i[d],i[d+1]))return!1;return!0}function o(t,r,o,c,u){if(!t)return!1;const f=n(r,o),{coords:s,lengths:i}=t;let l=!1,d=0;for(const n of i)l=e(l,s,f,d,n,c,u),d+=n*f;return l}function e(n,t,r,o,e,c,u){let f=n,s=o;for(let i=o,l=o+e*r;i<l;i+=r){s=i+r,s===l&&(s=o);const n=t[i],e=t[i+1],d=t[s],g=t[s+1];(e<u&&g>=u||g<u&&e>=u)&&n+(u-e)/(g-e)*(d-n)<c&&(f=!f)}return f}export{o as polygonContainsCoords,r as polygonContainsMultipoint,t as polygonContainsPoint};\r\n","/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\r\n*/\r\nimport{isNone as t}from\"../../../core/maybe.js\";import{getExpressionFromFieldName as e,getWhereClause as s,getAliasFromFieldName as i}from\"./attributeSupport.js\";import{getNormalizedValue as a}from\"../../../statistics/utils.js\";class r{constructor(t,a,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=a;const l=t.outFields;if(l&&-1===l.indexOf(\"*\")){this.outFields=l;let t=0;for(const a of l){const l=e(a),u=this.fieldsIndex.get(l),n=u?null:s(l,r),c=u?u.name:i(a)||\"FIELD_EXP_\"+t++;this._fieldDataCache.set(a,{alias:c,clause:n})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach((t=>this.getAttributes(t))),this._returnDistinctMap.size):t.length}getAttributes(t){const e=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(e)}getFieldValue(t,e,i){const a=i?i.name:e;let r=null;return this._fieldDataCache.has(a)?r=this._fieldDataCache.get(a).clause:i||(r=s(e,this.fieldsIndex),this._fieldDataCache.set(a,{alias:a,clause:r})),i?this.featureAdapter.getAttribute(t,a):r.calculateValue(t,this.featureAdapter)}getNormalizedValue(t,e){const s=e.normalizationType,i=e.normalizationTotal;let r=this.getFieldValue(t,e.field,e.fieldInfo);if(s&&Number.isFinite(r)){const l=this.getFieldValue(t,e.normalizationField,e.normalizationFieldInfo);r=a(r,s,l,i)}return r}getExpressionValue(t,e,s){const i={attributes:this.featureAdapter.getAttributes(t)},a=s.createExecContext(i,e.viewInfo);return s.executeFunction(e.compiledFunc,a)}validateItem(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:s(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testFeature(t,this.featureAdapter)}validateItems(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:s(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testSet(t,this.featureAdapter)}_processAttributesForOutFields(t){const e=this.outFields;if(!e||!e.length)return this.featureAdapter.getAttributes(t);const s={};for(const i of e){const{alias:e,clause:a}=this._fieldDataCache.get(i);s[e]=a?a.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,e)}return s}_processAttributesForDistinctValues(e){if(t(e)||!this.returnDistinctValues)return e;const s=this.outFields,i=[];if(s)for(const t of s){const{alias:s}=this._fieldDataCache.get(t);i.push(e[s])}else for(const t in e)i.push(e[t]);const a=`${(s||[\"*\"]).join(\",\")}=${i.join(\",\")}`;let r=this._returnDistinctMap.get(a)||0;return this._returnDistinctMap.set(a,++r),r>1?null:e}}export{r as default};\r\n","/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\r\n*/\r\nimport e from\"../../../core/Error.js\";import{clone as t}from\"../../../core/lang.js\";import{removeMaybe as i,destroyMaybe as s,isNone as r,isSome as a,isUndefined as n}from\"../../../core/maybe.js\";import{MemCacheStorage as u,MemCache as o}from\"../../../core/MemCache.js\";import{getMetersPerUnitForSR as c}from\"../../../core/unitUtils.js\";import{create as h,set as l,NEGATIVE_INFINITY as p,expandWithAABB as d}from\"../../../geometry/support/aaBoundingBox.js\";import{fromValues as y,create as m}from\"../../../geometry/support/aaBoundingRect.js\";import{getBoundsXY as f}from\"../../../geometry/support/boundsUtils.js\";import{fromJSON as x,isExtent as _,isPolygon as g}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as w}from\"../../../geometry/support/normalizeUtils.js\";import{equals as S,isValid as Q}from\"../../../geometry/support/spatialReferenceUtils.js\";import{validateFields as R,validateWhere as F,validateHaving as I,hasInvalidFieldType as E}from\"./attributeSupport.js\";import{project as j,checkProjectionSupport as b}from\"./projectionSupport.js\";import{queryCapabilities as k}from\"./QueryEngineCapabilities.js\";import A,{SnappingTypes as z}from\"./QueryEngineResult.js\";import{getSpatialQueryOperator as B,canQueryWithRBush as C,checkSpatialQuerySupport as T}from\"./spatialQuerySupport.js\";import{getTimeExtent as O}from\"./timeSupport.js\";import{cleanFromGeometryEngine as v,normalizeQuery as G,QUERY_ENGINE_EMPTY_RESULT as P}from\"./utils.js\";import q from\"../../support/FieldsIndex.js\";import{loadArcade as M}from\"../../../support/arcadeOnDemand.js\";import{noBudget as U}from\"../../../views/support/Scheduler.js\";function N(e){return e.every((e=>\"exceedslimit\"!==e.statisticType))}const Z=\"feature-store:unsupported-query\";class H{constructor(e,t=null,i,s,r){this.attributes=e,this.geometry=i,this.centroid=s,this.filterFlags=r,this.groupId=-1,this.displayId=t}}const D=new Set,J=new u(2e6);let L=0;class V{constructor(e){this.capabilities={query:k},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on(\"changed\",(()=>this.clearCache())),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new o(L+++\"$$\",J)),this.fieldsIndex=new q(e.fields),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=i(this._frameTask),this.clearCache(),s(this._geometryQueryCache),this._changeHandle=i(this._changeHandle),s(this.fieldsIndex)}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:v(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=O(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(e={},i){let s,r=t(e);try{r=await this._schedule((()=>G(r,this.definitionExpression,this.spatialReference)),i),r=await this._reschedule((()=>this._checkQuerySupport(r)),i),s=await this._reschedule((()=>this._executeGeometryQuery(r,i)),i),s=await this._reschedule((()=>s.executeAggregateIdsQuery(r)),i),s=await this._reschedule((()=>s.executeObjectIdsQuery(r)),i),s=await this._reschedule((()=>s.executeTimeQuery(r)),i),s=await this._reschedule((()=>s.executeAttributesQuery(r)),i)}catch(a){if(a!==P)throw a;s=new A([],null,this)}return s.createQueryResponse(r)}async executeQueryForCount(e={},i){let s=t(e);s.returnGeometry=!1,s.returnCentroid=!1,s.outSR=null;try{s=await this._schedule((()=>G(s,this.definitionExpression,this.spatialReference)),i),s=await this._reschedule((()=>this._checkQuerySupport(s)),i);let e=await this._reschedule((()=>this._executeGeometryQuery(s,i)),i);return e=await this._reschedule((()=>e.executeAggregateIdsQuery(s)),i),e=await this._reschedule((()=>e.executeObjectIdsQuery(s)),i),e=await this._reschedule((()=>e.executeTimeQuery(s)),i),e=await this._reschedule((()=>e.executeAttributesQuery(s)),i),e.createQueryResponseForCount(s)}catch(r){if(r!==P)throw r;return 0}}async executeQueryForExtent(e={},i){let s,r=t(e);const a=r.outSR;try{r=await this._schedule((()=>G(r,this.definitionExpression,this.spatialReference)),i),r=await this._reschedule((()=>this._checkQuerySupport(r)),i),r.returnGeometry=!0,r.returnCentroid=!1,r.outSR=null,s=await this._reschedule((()=>this._executeGeometryQuery(r,i)),i),s=await this._reschedule((()=>s.executeAggregateIdsQuery(r)),i),s=await this._reschedule((()=>s.executeObjectIdsQuery(r)),i),s=await this._reschedule((()=>s.executeTimeQuery(r)),i),s=await this._reschedule((()=>s.executeAttributesQuery(r)),i);const e=s.size;if(!e)return{count:e,extent:null};l(W,p),this.featureStore.forEachBounds(s.items,(e=>d(W,e)),$);const t={xmin:W[0],ymin:W[1],xmax:W[3],ymax:W[4],spatialReference:v(this.spatialReference)};this.hasZ&&isFinite(W[2])&&isFinite(W[5])&&(t.zmin=W[2],t.zmax=W[5]);const n=j(t,s.spatialReference,a);if(n.spatialReference=v(a||this.spatialReference),n.xmax-n.xmin==0){const e=c(n.spatialReference);n.xmin-=e,n.xmax+=e}if(n.ymax-n.ymin==0){const e=c(n.spatialReference);n.ymin-=e,n.ymax+=e}if(this.hasZ&&null!=n.zmin&&null!=n.zmax&&n.zmax-n.zmin==0){const e=c(n.spatialReference);n.zmin-=e,n.zmax+=e}return{count:e,extent:n}}catch(n){if(n===P)return{count:0,extent:null};throw n}}async executeQueryForIds(e={},t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e={},i){let s,r=t(e);r.returnGeometry=!1,r.returnCentroid=!1,r.outSR=null;try{r=await this._schedule((()=>G(r,this.definitionExpression,this.spatialReference)),i),r=await this._reschedule((()=>this._checkQuerySupport(r)),i),s=await this._reschedule((()=>this._executeGeometryQuery(r,i)),i),s=await this._reschedule((()=>s.executeAggregateIdsQuery(r)),i),s=await this._reschedule((()=>s.executeObjectIdsQuery(r)),i),s=await this._reschedule((()=>s.executeTimeQuery(r)),i),s=await this._reschedule((()=>s.executeAttributesQuery(r)),i);const e=s.items,t=new Set;return await this._reschedule((()=>{for(const i of e)t.add(s.featureAdapter.getObjectId(i))}),i),t}catch(a){if(a===P)return new Set;throw a}}async executeQueryForSnapping(e,t){const{point:i,distance:s,types:a}=e;if(a===z.NONE)return{candidates:[]};const n=await this._reschedule((()=>this._checkQuerySupport(e.query)),t),u=!S(i.spatialReference,this.spatialReference);u&&await b(i.spatialReference,this.spatialReference);const o=\"number\"==typeof s?s:s.x,c=\"number\"==typeof s?s:s.y,h={xmin:i.x-o,xmax:i.x+o,ymin:i.y-c,ymax:i.y+c,spatialReference:i.spatialReference},l=u?j(h,this.spatialReference):h;if(!l)return{candidates:[]};const p=(await w(x(i),null,{signal:t}))[0],d=(await w(x(l),null,{signal:t}))[0];if(r(p)||r(d))return{candidates:[]};let y=new A(this._searchFeatures(this._getQueryBBoxes(d.toJSON())),null,this);y=await this._reschedule((()=>y.executeObjectIdsQuery(n)),t),y=await this._reschedule((()=>y.executeTimeQuery(n)),t),y=await this._reschedule((()=>y.executeAttributesQuery(n)),t);const m=p.toJSON(),f=u?j(m,this.spatialReference):m,_=u?Math.max(l.xmax-l.xmin,l.ymax-l.ymin)/2:s;return y.createSnappingResponse({...e,point:f,distance:_},i.spatialReference)}async executeQueryForLatestObservations(i={},s){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new e(Z,\"Missing timeInfo or timeInfo.trackIdField\",{query:i,timeInfo:this.timeInfo});let r,a=t(i);try{a=await this._schedule((()=>G(a,this.definitionExpression,this.spatialReference)),s),a=await this._reschedule((()=>this._checkQuerySupport(a)),s),r=await this._reschedule((()=>this._executeGeometryQuery(a,s)),s),r=await this._reschedule((()=>r.executeAggregateIdsQuery(a)),s),r=await this._reschedule((()=>r.executeObjectIdsQuery(a)),s),r=await this._reschedule((()=>r.executeTimeQuery(a)),s),r=await this._reschedule((()=>r.executeAttributesQuery(a)),s),r=await this._reschedule((()=>r.filterLatest()),s)}catch(n){if(n!==P)throw n;r=new A([],null,this)}return r.createQueryResponse(a)}async executeQueryForSummaryStatistics(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createSummaryStatisticsResponse(e,t)}async executeQueryForUniqueValues(e={},t,i){const{field:s,valueExpression:r}=t;return(await this._getQueryEngineResultForStats(e,{field:s,valueExpression:r},i)).createUniqueValuesResponse(e,t)}async executeQueryForClassBreaks(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createClassBreaksResponse(e,t)}async executeQueryForHistogram(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createHistogramResponse(e,t)}async _schedule(e,t){return a(this._frameTask)?this._frameTask.schedule(e,t):e(U)}async _reschedule(e,t){return a(this._frameTask)?this._frameTask.reschedule(e,t):e(U)}_getAll(){if(!this._allItems){const e=[];this.featureStore.forEach((t=>e.push(t))),this._allItems=new A(e,null,this)}return this._allItems}async _executeGeometryQuery(e,t){const{geometry:i,outSR:s,spatialRel:r,returnGeometry:a,returnCentroid:u}=e,o=this.featureStore.featureSpatialReference,c=i&&o&&o!==i.spatialReference?j(i,o):i,h=a||u,l=Q(s)&&!S(this.spatialReference,s),p=this._geometryQueryCache?l&&h?JSON.stringify({originalFilterGeometry:i,spatialRelationship:r,outSpatialReference:s}):JSON.stringify({originalFilterGeometry:i,spatialRelationship:r}):null;if(p){const e=this._geometryQueryCache.get(p);if(!n(e))return e}const d=async e=>{if(l&&h){const t=await e.project(s);return p&&this._geometryQueryCache.put(p,t,t.size||1),t}return p&&this._geometryQueryCache.put(p,e,e.size||1),e};if(!c)return d(this._getAll());const y=this.featureAdapter;if(\"esriSpatialRelDisjoint\"===r){const e=this._searchFeatures(this._getQueryBBoxes(i));if(!e.length)return d(this._getAll());let s,a;const n=new Set;for(const t of e)n.add(y.getObjectId(t));await this._reschedule((()=>{let e=0;s=new Array(n.size),this.featureStore.forEach((t=>s[e++]=t)),a=n}),t);const u=await this._reschedule((async()=>{const e=await B(r,c,this.geometryType,this.hasZ,this.hasM),n=t=>!a.has(y.getObjectId(t))||e(y.getGeometry(t));return new A(await this._runSpatialFilter(s,n,t),i,this)}),t);return d(u)}const m=this._searchFeatures(this._getQueryBBoxes(i));if(!m.length){const e=new A([],i,this);return p&&this._geometryQueryCache.put(p,e,e.size||1),e}if(this._canExecuteSoloPass(c,e))return d(new A(m,i,this));const f=await B(r,c,this.geometryType,this.hasZ,this.hasM),x=await this._runSpatialFilter(m,(e=>f(y.getGeometry(e))),t);return d(new A(x,i,this))}async _runSpatialFilter(e,t,i){if(!t)return e;if(r(this._frameTask))return e.filter((e=>t(e)));let s=0;const a=new Array,n=async r=>{for(;s<e.length;){const u=e[s++];t(u)&&(a.push(u),r.madeProgress()),r.done&&await this._reschedule((e=>n(e)),i)}};return this._reschedule((e=>n(e)),i).then((()=>a))}_canExecuteSoloPass(e,t){const{geometryType:i}=this,{spatialRel:s}=t;return C(e)&&(\"esriSpatialRelEnvelopeIntersects\"===s||\"esriGeometryPoint\"===i&&(\"esriSpatialRelIntersects\"===s||\"esriSpatialRelContains\"===s||\"esriSpatialRelWithin\"===s))}_getQueryBBoxes(e){if(C(e)){if(_(e))return[y(e.xmin,e.ymin,e.xmax,e.ymax)];if(g(e))return e.rings.map((e=>y(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[f(m(),e)]}_searchFeatures(e){for(const s of e)this.featureStore.forEachInBounds(s,(e=>{D.add(e)}));const t=new Array(D.size);let i=0;return D.forEach((e=>t[i++]=e)),D.clear(),t}async _checkStatisticsSupport(t,i){if(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)throw new e(Z,\"Unsupported query options\",{query:t});return Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsParamsSupport(i),T(t,this.geometryType,this.spatialReference),b(this.spatialReference,t.outSR)]).then((()=>t))}async _checkStatisticsParamsSupport(t){let i=[];if(t.valueExpression){const{arcadeUtils:e}=await M();i=e.extractFieldNames(t.valueExpression)}if(t.field&&i.push(t.field),t.normalizationField&&i.push(t.normalizationField),!i.length)throw new e(Z,\"params should have at least a field or valueExpression\",{params:t});R(this.fieldsIndex,i,\"params contains missing fields\")}async _checkQuerySupport(t){if(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)throw new e(Z,\"Unsupported query options\",{query:t});return Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),T(t,this.geometryType,this.spatialReference),b(this.spatialReference,t.outSR)]).then((()=>t))}_checkAttributesQuerySupport(t){const{outFields:i,orderByFields:s,returnDistinctValues:r,outStatistics:a}=t,n=a?a.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())).filter(Boolean):[];if(s&&s.length>0){const e=\" asc\",t=\" desc\",i=s.map((i=>{const s=i.toLowerCase();return s.indexOf(e)>-1?s.split(e)[0]:s.indexOf(t)>-1?s.split(t)[0]:i})).filter((e=>-1===n.indexOf(e)));R(this.fieldsIndex,i,\"orderByFields contains missing fields\")}if(i&&i.length>0)R(this.fieldsIndex,i,\"outFields contains missing fields\");else if(r)throw new e(Z,\"outFields should be specified for returnDistinctValues\",{query:t});F(this.fieldsIndex,t.where)}async _checkStatisticsQuerySupport(t){const{outStatistics:i,groupByFieldsForStatistics:s,having:r}=t,a=s&&s.length,n=i&&i.length;if(r){if(!a||!n)throw new e(Z,\"outStatistics and groupByFieldsForStatistics should be specified with having\",{query:t});I(this.fieldsIndex,r,i)}if(n){if(!N(i))return;const r=i.map((e=>e.onStatisticField)).filter(Boolean);R(this.fieldsIndex,r,\"onStatisticFields contains missing fields\"),a&&R(this.fieldsIndex,s,\"groupByFieldsForStatistics contains missing fields\");for(const s of i){const{onStatisticField:i,statisticType:r}=s;if((\"percentile_disc\"===r||\"percentile_cont\"===r)&&\"statisticParameters\"in s){const{statisticParameters:i}=s;if(!i)throw new e(Z,\"statisticParamters should be set for percentile type\",{definition:s,query:t})}else if(\"count\"!==r&&i&&E(i,this.fieldsIndex))throw new e(Z,\"outStatistics contains non-numeric fields\",{definition:s,query:t})}}}async _getQueryEngineResultForStats(e={},i,s){let r;e=t(e);try{e=await this._schedule((()=>G(e,this.definitionExpression,this.spatialReference)),s),e=await this._reschedule((()=>this._checkStatisticsSupport(e,i)),s),r=await this._reschedule((()=>this._executeGeometryQuery(e,s)),s),r=await this._reschedule((()=>r.executeAggregateIdsQuery(e)),s),r=await this._reschedule((()=>r.executeObjectIdsQuery(e)),s),r=await this._reschedule((()=>r.executeTimeQuery(e)),s),r=await this._reschedule((()=>r.executeAttributesQuery(e)),s)}catch(a){if(a!==P)throw a;r=new A([],null,this)}return r}}const $=h(),W=h();export{H as Feature,V as default};\r\n","/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\r\n*/\r\nfunction t(t,n){if(!t)return null;const e=n.featureAdapter,{startTimeField:u,endTimeField:l}=t;let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(u&&l)n.forEach((t=>{const n=e.getAttribute(t,u),o=e.getAttribute(t,l);null==n||isNaN(n)||(r=Math.min(r,n)),null==o||isNaN(o)||(i=Math.max(i,o))}));else{const t=u||l;n.forEach((n=>{const u=e.getAttribute(n,t);null==u||isNaN(u)||(r=Math.min(r,u),i=Math.max(i,u))}))}return{start:r,end:i}}function n(t,n,r){if(!n||!t)return null;const{startTimeField:i,endTimeField:o}=t;if(!i&&!o)return null;const{start:s,end:a}=n;return null===s&&null===a?null:void 0===s&&void 0===a?l():i&&o?e(r,i,o,s,a):u(r,i||o,s,a)}function e(t,n,e,u,l){return null!=u&&null!=l?r=>{const i=t.getAttribute(r,n),o=t.getAttribute(r,e);return(null==i||i<=l)&&(null==o||o>=u)}:null!=u?n=>{const l=t.getAttribute(n,e);return null==l||l>=u}:null!=l?e=>{const u=t.getAttribute(e,n);return null==u||u<=l}:void 0}function u(t,n,e,u){return null!=e&&null!=u&&e===u?u=>t.getAttribute(u,n)===e:null!=e&&null!=u?l=>{const r=t.getAttribute(l,n);return r>=e&&r<=u}:null!=e?u=>t.getAttribute(u,n)>=e:null!=u?e=>t.getAttribute(e,n)<=u:void 0}function l(){return()=>!1}export{t as getTimeExtent,n as getTimeOperator};\r\n","/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\r\n*/\r\nconst t={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};export{t as queryCapabilities};\r\n","/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\r\n*/\r\nimport e from\"../../../core/Error.js\";import{WhereClauseCache as i}from\"../../../core/sql/WhereClauseCache.js\";const s=new i(50,500),n=\"feature-store:unsupported-query\",t=\" as \",r=new Set([\"esriFieldTypeOID\",\"esriFieldTypeSmallInteger\",\"esriFieldTypeInteger\",\"esriFieldTypeSingle\",\"esriFieldTypeDouble\",\"esriFieldTypeLong\",\"esriFieldTypeDate\"]);function o(i,t){if(!t)return!0;const r=s.get(t,i);if(!r)throw new e(n,\"invalid SQL expression\",{where:t});if(!r.isStandardized)throw new e(n,\"where clause is not standard\",{where:t});return c(i,r.fieldNames,\"where clause contains missing fields\"),!0}function a(i,t,r){if(!t)return!0;const o=s.get(t,i);if(!o)throw new e(n,\"invalid SQL expression\",{having:t});if(!o.isAggregate)throw new e(n,\"having does not contain a valid aggregate function\",{having:t});const a=o.fieldNames;c(i,a,\"having contains missing fields\");if(!o.getExpressions().every((e=>{const{aggregateType:s,field:n}=e,t=i.has(n)&&i.get(n).name;return r.some((e=>{const{onStatisticField:n,statisticType:r}=e;return(i.has(n)&&i.get(n).name)===t&&r.toLowerCase().trim()===s}))})))throw new e(n,\"expressions in having should also exist in outStatistics\",{having:t});return!0}function l(e,i){return e?s.get(e,i):null}function c(i,s,t,r=!0){const o=[];for(const u of s)if(\"*\"!==u&&!i.has(u))if(r){const s=d(u);try{const t=l(s,i);if(!t)throw new e(n,\"invalid SQL expression\",{where:s});if(!t.isStandardized)throw new e(n,\"expression is not standard\",{clause:t});c(i,t.fieldNames,\"expression contains missing fields\")}catch(a){const e=a&&a.details;if(e&&(e.clause||e.where))throw a;e&&e.missingFields?o.push(...e.missingFields):o.push(u)}}else o.push(u);if(o.length)throw new e(n,t,{missingFields:o})}function d(e){return e.split(t)[0]}function u(e){return e.split(t)[1]}function f(e,i){const s=i.get(e);return!!s&&!r.has(s.type)}export{u as getAliasFromFieldName,d as getExpressionFromFieldName,l as getWhereClause,f as hasInvalidFieldType,c as validateFields,a as validateHaving,o as validateWhere};\r\n"],"sourceRoot":"webpack:///"}